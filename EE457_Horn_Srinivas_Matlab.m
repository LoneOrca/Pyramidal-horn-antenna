%--------------------------------------------------------------------

A = 166.8913;
B = 133.6655;
a = 15.7988;
b = 7.8994;
lambda = 21.4286;

%--------------------------------------------------------------------

R0_H = A^2 / (3*lambda);
RH = (A - a) / A * R0_H;
L_H = sqrt(R0_H^2 + (A/2)^2);
alpha_H = atand(0.5*A/R0_H);
R0_E = B^2 / (2*lambda);
RE = (B - b) / B * R0_E;
L_E = sqrt(R0_E^2 + (B/2)^2);
alpha_E = atand(0.5*B/R0_E);

%--------------------------------------------------------------------

t = A^2 / (8*lambda*R0_H);
T1 =  (A/lambda)^2 /(8*t);
T2 = ( sqrt(1 + 16*(lambda/A)^2*t^2) - 1 );
t_e = T1 * T2;
p1 = 2*sqrt(t_e) * (+1 + 1/(8*t_e));
p2 = 2*sqrt(t_e) * (-1 + 1/(8*t_e));
C1 = fresnelc(p1);
C2 = fresnelc(p2);
S1 = fresnels(p1);
S2 = fresnels(p2);

%--------------------------------------------------------------------

s = B^2 / (8*lambda*R0_E);
T1 = (B/lambda)^2 /(8*s);
T2 = ( sqrt(1 + 16*(lambda/B)^2*s^2) - 1 );
s_e =  T1 *T2 ;
q = 2 * sqrt(s_e);
Cq = fresnelc(q);
Sq = fresnels(q);

%--------------------------------------------------------------------

e_t = 8 / pi^2;
e_E = ( Cq^2 + Sq^2 ) / q^2;
e_H = pi^2 / (64*t_e) * ( (C1-C2)^2 + (S1-S2)^2 );
e_ap = e_t * e_E * e_H*100;
X = 0.68*(lambda/A);
Y = 0.47*(lambda/b);


%--------------------------------------------------------------------
